.header
  - if @run_record.hits < 2
    #permalink-indicator
      &uarr; That's your permalink!
  %h2 #{@run.title}
- run_time = 0
- @run.splits.each do |split|
  - run_time += split.time.to_s.to_f
- colors = [:blue, :purple, :green, :red, :orange, :yellow]
- c = 0
- percentage = 0
.size-chart.l-vbox.pure-g{style: "margin-bottom: 30px;"}
  - @run.splits.each do |s|
    - percentage += s.time.to_s.to_f/run_time*100
  - @run.splits.each do |split|
    .size-chart-item.pure-u{class: "size-chart-" + colors[c].to_s, style: "width: #{split.time.to_s.to_f/run_time*100 + (100 - percentage)/@run.splits.length}%;"}
      .size-chart-label{href: "/base/", style: "white-space: nowrap;"}
        = split.title
        %span.size-chart-size
          = Time.at(split.time.to_s.to_f).utc.strftime("%H:%M:%S")
    - c = (c + 1) % colors.length
.content
  %table.pure-table{style: "margin: auto;"}
    %thead
      %tr
        %th #
        %th Title
        %th Duration
        %th Finished at
    %tbody
      - i = 0
      - @run.splits.each do |split|
        %tr
          %td.align-right
            = i +=1
          %td
            = split.title
          %td.align-right
            = Time.at(split.time.to_s.to_f).utc.strftime("%H:%M:%S")
          %td.align-right
            = Time.at(split.time.to_s.to_f).utc.strftime("%H:%M:%S")
  .run-footer
    %a{href: upload_path} upload
    &bull;
    %a{href: download_run_path(@run_record.nick)} download
    &bull;
    %a{href: "https://github.com/skoh-fley/splits.io", target: :_blank} github
- if @run_record.hits < 2
  :javascript
    $('#permalink-indicator').fadeIn().delay(4000).fadeOut();
